---
apiVersion: admissionregistration.k8s.io/v1
kind: MutatingWebhookConfiguration
metadata:
  name: mutating-webhook-configuration
webhooks:
- admissionReviewVersions:
  - v1
  clientConfig:
      url: https://host.docker.internal:9443/mutate--v1-service
      caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUR0VENDQXAyZ0F3SUJBZ0lVTFB5RHg0c21md3NOOG1oNGl2QURnOXlWbkNJd0RRWUpLb1pJaHZjTkFRRUwKQlFBd1ZERUxNQWtHQTFVRUJoTUNUazh4RWpBUUJnTlZCQWdNQ1ZSU1QwNUVSVXhCUnpFU01CQUdBMVVFQnd3SgpWSEp2Ym1Sb1pXbHRNUjB3R3dZRFZRUUREQlJvYjNOMExtUnZZMnRsY2k1cGJuUmxjbTVoYkRBZUZ3MHlOVEV3Ck1qQXdOakV4TVRkYUZ3MHlOakV3TWpBd05qRXhNVGRhTUZReEN6QUpCZ05WQkFZVEFrNVBNUkl3RUFZRFZRUUkKREFsVVVrOU9SRVZNUVVjeEVqQVFCZ05WQkFjTUNWUnliMjVrYUdWcGJURWRNQnNHQTFVRUF3d1VhRzl6ZEM1awpiMk5yWlhJdWFXNTBaWEp1WVd3d2dnRWlNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0SUJEd0F3Z2dFS0FvSUJBUURVCmhGMXJXRVNxZmt3RCtXaDZpVGlrNUxFME5wWFhYUlgyTFkwMnlXYWNzOVo4cEZGZ3FBTkxoVFFiZ2o5bmZKNHoKUmw4YWdCN3NtVjR0NXNyRytxaWVyc2ZKamZJcUZ5cUlvd1o3MmJySFB5Y09QVENRYlFtdVk5dVV3SzUyVnhQbgpjZkhDNm1wZ1ROaWthZ0hPZHVROGdNUTZpQ21naDR4MGZzSDJ5MW5vanZaRnVaSTRBVWVsZlY2cmlmNDEwZVdaCnlOckRWRk9KdXNsSXB1UmEwb3d6WDNrMDdReE1BR3FNbGdCRllaQmo3MzRFS2g5VzlNaFdsMjVRSUtHSXFCWWgKenpUSVREaE14NW95cDkyakVoVjNlOWJhR3JGQ2RHeHlWSEdYcXRPdkR1Mk4rRUY3K3JCTXZERlNRVUJoVjlVZgorZlp0ZGNTTVk0SFJSdnZiYUpFWkFnTUJBQUdqZnpCOU1CMEdBMVVkRGdRV0JCU2pmVEFlcEhMYWFVcGNoMTNrCnVqd2daZERvOFRBZkJnTlZIU01FR0RBV2dCU2pmVEFlcEhMYWFVcGNoMTNrdWp3Z1pkRG84VEFQQmdOVkhSTUIKQWY4RUJUQURBUUgvTUNvR0ExVWRFUVFqTUNHQ0NXeHZZMkZzYUc5emRJSVVhRzl6ZEM1a2IyTnJaWEl1YVc1MApaWEp1WVd3d0RRWUpLb1pJaHZjTkFRRUxCUUFEZ2dFQkFNZm1sbktxNXdaNTF4SGZLaHlGdTRRdy9JWTZ2ZGZrCjRLS1BzTUlVbkdTMlZ5cDlRWCtVOWJINXVrWTF4S2NScy9lNkxXMTY1SktQZXI4YzFSVDVxanoxMmM1U2IvZysKREtnRVhxemdqaVpIRTd1MFFZWGd5SmNwQ2l6WGhLdjVXVHdmbmsrME03UjJQSlRoNllrdHo1dDJHUnFWL3ltVQppWmdMWGxXZEtnYmNidEtmanVlSm1vek5ETU8yU1RBNGJxNy8vMEw5QWxIYWZMVlZJbWxoTjdIbTRWY2tyUm9xCmt1UEYyOC93bTJzZjlxWG96ZFlhd3pzZUlab3FBVWtYSnhiWW1lWldTZ0t5dk11SjhIOGQ4NXBFeS84bHlGangKUW1IRmF5RTh4cjRuNkxJSWs2N1FkRGlwTkErYmFVNDVZdHF6L2RpbEdISXBRT2lQckIrL2tocz0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=
  failurePolicy: Fail
  name: host.docker.internal
  rules:
  - apiGroups:
    - ""
    apiVersions:
    - v1
    operations:
    - CREATE
    - UPDATE
    resources:
    - services
  sideEffects: NoneOnDryRun
  namespaceSelector:
    matchExpressions:
      - key: kubernetes.io/metadata.name
        operator: NotIn
        values:
          - cert-manager
          - kube-node-lease
          - kube-public
          - kube-system
          - kubemacpool-system
          - kubelet-serving-cert-approver
          - kubevirt
          - eventus
          - fluent
          - kyverno
          - metallb-system
          - monitoring
          - rook-ceph
          - falco
          - trivy-system
---
apiVersion: admissionregistration.k8s.io/v1
kind: ValidatingWebhookConfiguration
metadata:
  name: validating-webhook-configuration
webhooks:
- admissionReviewVersions:
  - v1
  name: host.docker.internal
  clientConfig:
      url: https://host.docker.internal:9443/validate--v1-service
      caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUR0VENDQXAyZ0F3SUJBZ0lVTFB5RHg0c21md3NOOG1oNGl2QURnOXlWbkNJd0RRWUpLb1pJaHZjTkFRRUwKQlFBd1ZERUxNQWtHQTFVRUJoTUNUazh4RWpBUUJnTlZCQWdNQ1ZSU1QwNUVSVXhCUnpFU01CQUdBMVVFQnd3SgpWSEp2Ym1Sb1pXbHRNUjB3R3dZRFZRUUREQlJvYjNOMExtUnZZMnRsY2k1cGJuUmxjbTVoYkRBZUZ3MHlOVEV3Ck1qQXdOakV4TVRkYUZ3MHlOakV3TWpBd05qRXhNVGRhTUZReEN6QUpCZ05WQkFZVEFrNVBNUkl3RUFZRFZRUUkKREFsVVVrOU9SRVZNUVVjeEVqQVFCZ05WQkFjTUNWUnliMjVrYUdWcGJURWRNQnNHQTFVRUF3d1VhRzl6ZEM1awpiMk5yWlhJdWFXNTBaWEp1WVd3d2dnRWlNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0SUJEd0F3Z2dFS0FvSUJBUURVCmhGMXJXRVNxZmt3RCtXaDZpVGlrNUxFME5wWFhYUlgyTFkwMnlXYWNzOVo4cEZGZ3FBTkxoVFFiZ2o5bmZKNHoKUmw4YWdCN3NtVjR0NXNyRytxaWVyc2ZKamZJcUZ5cUlvd1o3MmJySFB5Y09QVENRYlFtdVk5dVV3SzUyVnhQbgpjZkhDNm1wZ1ROaWthZ0hPZHVROGdNUTZpQ21naDR4MGZzSDJ5MW5vanZaRnVaSTRBVWVsZlY2cmlmNDEwZVdaCnlOckRWRk9KdXNsSXB1UmEwb3d6WDNrMDdReE1BR3FNbGdCRllaQmo3MzRFS2g5VzlNaFdsMjVRSUtHSXFCWWgKenpUSVREaE14NW95cDkyakVoVjNlOWJhR3JGQ2RHeHlWSEdYcXRPdkR1Mk4rRUY3K3JCTXZERlNRVUJoVjlVZgorZlp0ZGNTTVk0SFJSdnZiYUpFWkFnTUJBQUdqZnpCOU1CMEdBMVVkRGdRV0JCU2pmVEFlcEhMYWFVcGNoMTNrCnVqd2daZERvOFRBZkJnTlZIU01FR0RBV2dCU2pmVEFlcEhMYWFVcGNoMTNrdWp3Z1pkRG84VEFQQmdOVkhSTUIKQWY4RUJUQURBUUgvTUNvR0ExVWRFUVFqTUNHQ0NXeHZZMkZzYUc5emRJSVVhRzl6ZEM1a2IyTnJaWEl1YVc1MApaWEp1WVd3d0RRWUpLb1pJaHZjTkFRRUxCUUFEZ2dFQkFNZm1sbktxNXdaNTF4SGZLaHlGdTRRdy9JWTZ2ZGZrCjRLS1BzTUlVbkdTMlZ5cDlRWCtVOWJINXVrWTF4S2NScy9lNkxXMTY1SktQZXI4YzFSVDVxanoxMmM1U2IvZysKREtnRVhxemdqaVpIRTd1MFFZWGd5SmNwQ2l6WGhLdjVXVHdmbmsrME03UjJQSlRoNllrdHo1dDJHUnFWL3ltVQppWmdMWGxXZEtnYmNidEtmanVlSm1vek5ETU8yU1RBNGJxNy8vMEw5QWxIYWZMVlZJbWxoTjdIbTRWY2tyUm9xCmt1UEYyOC93bTJzZjlxWG96ZFlhd3pzZUlab3FBVWtYSnhiWW1lWldTZ0t5dk11SjhIOGQ4NXBFeS84bHlGangKUW1IRmF5RTh4cjRuNkxJSWs2N1FkRGlwTkErYmFVNDVZdHF6L2RpbEdISXBRT2lQckIrL2tocz0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=
  failurePolicy: Fail
  rules:
  - apiGroups:
    - ""
    apiVersions:
    - v1
    operations:
    - CREATE
    - UPDATE
    - DELETE
    resources:
    - services
  sideEffects: None
  namespaceSelector:
    matchExpressions:
      - key: kubernetes.io/metadata.name
        operator: NotIn
        values:
          - cert-manager
          - kube-node-lease
          - kube-public
          - kube-system
          - kubemacpool-system
          - kubelet-serving-cert-approver
          - kubevirt
          - eventus
          - fluent
          - kyverno
          - metallb-system
          - monitoring
          - rook-ceph
          - falco
          - trivy-system          
